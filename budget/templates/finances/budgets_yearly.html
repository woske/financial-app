{% extends 'base.html' %}

{% block content %}
<form method="get">
  <label for="year">Year:</label>
  <select id="year" name="year">
    {% for year in years %}
    <option value="{{ year }}" {% if year == selected_year %}selected{% endif %}>{{ year }}</option>
    {% endfor %}
  </select>
  <button type="submit">Go</button>
</form>

<h2 style="text-align: left;">Expenses {{selected_year}}</h2>
<table>
  <thead>
    <tr>
      <th>Category</th>
      {% for month in months.values %}
      <th>{{ month }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for category, month_data in expenses.items %}
    <tr>
      <td>{{ category }}</td>
      {% for month, item in month_data.items %}
      <td{% if item.spent > item.budget %} style="color: red;"{% elif item.spent < item.budget %} style="color: green;"{% endif %}>{{ item.spent|floatformat:2 }} (Budget: {{ item.budget|floatformat:2 }})</td>
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>

<h2 style="text-align: left;">Income {{selected_year}}</h2>
<table>
  <thead>
    <tr>
      <th>Caregory</th>
      {% for month in months.values %}
      <th>{{ month }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for category, month_data in income.items %}
    <tr>
      <td>{{ category }}</td>
      {% for month, item in month_data.items %}
        {% if month in month_data %}
          <td{% if item.spent > item.budget %} style="color: red;"{% elif item.spent < item.budget %} style="color: green;"{% endif %}>{{ item.spent|floatformat:2 }} (Budget: {{ item.budget|floatformat:2 }})</td>
        {% else %}
          <td></td>
        {% endif %}
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- <form method="get">
  <div class="form-group">
    <label for="year">Select year:</label>
    <select class="form-control" name="year" id="year">
      {% for year in years %}
        <option value="{{ year }}" {% if selected_year == year %}selected{% endif %}>{{ year }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="form-group">
    <label for="month">Select month:</label>
    <select name="month" id="month" class="form-control">
        {% for month_number, month_name in months.items %}
            <option value="{{ month_number }}" {% if month_number == selected_month %}selected{% endif %}>
                {{ month_name }}
            </option>
        {% endfor %}
    </select>
</div>


  <button type="submit" class="btn btn-primary">Submit</button>
</form>

<div id="bar-chart"></div>

<script>
  var chartData = JSON.parse('{{ fig_json|escapejs }}');
  Plotly.newPlot("bar-chart", chartData.data, chartData.layout);
</script> -->



  
  {% endblock %}